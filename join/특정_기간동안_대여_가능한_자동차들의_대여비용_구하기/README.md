### 새로 알게 된 잡 기술
`WHERE`는 ALIAS를 지원하지 않기 때문에, `HAVING`으로 해도 로직에 상관 없다면<br>
`HAVING`에서 ALIAS를 사용해 가독성이 좋아질 수 있다.<br>

### 문제를 해메서 만든 테스트케이스
```sql
-- create a table
CREATE TABLE CAR_RENTAL_COMPANY_CAR (
  CAR_ID INTEGER PRIMARY KEY,
  CAR_TYPE TEXT NOT NULL,
  DAILY_FEE INTEGER NOT NULL
);
-- insert some values
INSERT INTO CAR_RENTAL_COMPANY_CAR VALUES (1, 'SUV', 25000);
INSERT INTO CAR_RENTAL_COMPANY_CAR VALUES (2, '세단', 14000);
INSERT INTO CAR_RENTAL_COMPANY_CAR VALUES (3, '트럭', 32000);
INSERT INTO CAR_RENTAL_COMPANY_CAR VALUES (4, '세단', 12000);
INSERT INTO CAR_RENTAL_COMPANY_CAR VALUES (5, '세단', 22000);

-- create a table
CREATE TABLE CAR_RENTAL_COMPANY_RENTAL_HISTORY (
  HISTORY_ID INTEGER PRIMARY KEY,
  CAR_ID INTEGER NOT NULL,
  START_DATE DATE NOT NULL,
  END_DATE DATE NOT NULL
);
-- insert some values
INSERT INTO CAR_RENTAL_COMPANY_RENTAL_HISTORY VALUES (1, 1, '2022-08-27', '2022-09-02');
INSERT INTO CAR_RENTAL_COMPANY_RENTAL_HISTORY VALUES (2, 1, '2022-10-03', '2022-10-04');
INSERT INTO CAR_RENTAL_COMPANY_RENTAL_HISTORY VALUES (3, 2, '2022-10-05', '2022-10-20');
INSERT INTO CAR_RENTAL_COMPANY_RENTAL_HISTORY VALUES (4, 2, '2022-10-10', '2022-11-12');
INSERT INTO CAR_RENTAL_COMPANY_RENTAL_HISTORY VALUES (5, 3, '2022-10-16', '2022-10-17');


-- create a table
CREATE TABLE CAR_RENTAL_COMPANY_DISCOUNT_PLAN (
  PLAN_ID INTEGER PRIMARY KEY,
  CAR_TYPE TEXT NOT NULL,
  DURATION_TYPE TEXT NOT NULL,
  DISCOUNT_RATE INTEGER NOT NULL
);
-- insert some values
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (1, '트럭', '7일 이상', 5);
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (2, '트럭', '30일 이상', 7);
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (3, '트럭', '90일 이상', 10);
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (4, '세단', '7일 이상', 5);
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (5, '세단', '30일 이상', 10);
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (6, '세단', '90일 이상', 15);
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (7, 'SUV', '7일 이상', 3);
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (8, 'SUV', '30일 이상', 8);
INSERT INTO CAR_RENTAL_COMPANY_DISCOUNT_PLAN VALUES (9, 'SUV', '90일 이상', 12);


-- 코드를 입력하세요
WITH WANTED (CAR_ID, CAR_TYPE, DAILY_FEE) AS
(
    SELECT DISTINCT WANTED_CARS.CAR_ID, WANTED_CARS.CAR_TYPE, WANTED_CARS.DAILY_FEE
        FROM (
            SELECT CAR_ID, CAR_TYPE, DAILY_FEE
                FROM CAR_RENTAL_COMPANY_CAR
                WHERE CAR_TYPE IN ('세단', 'SUV')
        ) AS WANTED_CARS
        WHERE CAR_ID NOT IN (
            SELECT DISTINCT CAR_ID
                FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
                WHERE START_DATE <= '2022-11-01'
                    AND END_DATE >= '2022-11-01'
        )
)

SELECT WANTED.CAR_ID, WANTED.CAR_TYPE,
        ROUND(WANTED.DAILY_FEE * (1 - (PLAN.DISCOUNT_RATE / 100)) * 30) AS FEE
    FROM WANTED
    INNER JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN AS PLAN
        ON WANTED.CAR_TYPE = PLAN.CAR_TYPE
            AND PLAN.DURATION_TYPE = '30일 이상'
    HAVING FEE BETWEEN 500000 AND 2000000
    ORDER BY FEE DESC, CAR_TYPE ASC, CAR_ID DESC;

```

### Reference
[문제](https://school.programmers.co.kr/learn/courses/30/lessons/157339)<br>